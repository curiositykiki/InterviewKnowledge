# IPC方式：

1. 无名管道pipe：

   管道实际是用于进程间通信的一段共享内存，**创建管道的进程称为管道服务器，连接到一个管道的进程为管道客户机**。一个进程在向管道写入数据后，另一进程就可以从管道的另一端将其读取出来。

   **管道的特点：**

   1. 管道是**半双工的，数据只能向一个方向流动**；需要**双方通信时，需要建立起两个管道**；

   2. **只能用于父子进程或者兄弟进程之间（具有亲缘关系的进程）。**比如fork或exec创建的新进程，在使用exec创建新进程时，需要将管道的文件描述符作为参数传递给exec创建的新进程。当父进程与使用fork创建的子进程直接通信时，发送数据的进程关闭读端，接受数据的进程关闭写端。

   3. 单独构成一种独立的文件系统：**管道对于管道两端的进程而言，就是一个文件**，但它不是普通的文件，它不属于某种文件系统，而是自立门户，单独构成一种文件系统，并且只存在与内存中。

   4. 数据的读出和写入：一个进程向管道中写的内容被管道另一端的进程读出。写入的内容每次都添加在管道缓冲区的末尾，并且每次都是从缓冲区的头部读出数据。

   　　**管道的实现机制：**

   　　管道是由内核管理的一个缓冲区，相当于我们放入内存中的一个纸条。管道的一端连接一个进程的输出。这个进程会向管道中放入信息。管道的另一端连接一个进程的输入，这个进程取出被放入管道的信息。**一个缓冲区不需要很大，它被设计成为环形的数据结构，以便管道可以被循环利用。**当管道中没有信息的话，从管道中读取的进程会等待，直到另一端的进程放入信息。当管道被放满信息的时候，尝试放入信息的进程会等待，直到另一端的进程取出信息。当两个进程都终结的时候，管道也自动消失。管道只能在本地计算机中使用，而**不可用于网络间的通信。**

2. 命名管道FIFO：

   命名管道是一种特殊类型的文件，它在系统中以文件形式存在。这样克服了无名管道的弊端，他可以**允许没有亲缘关系的进程间通信**。

   **命名管道的特点：**

   对于命名管道FIFO来说，IO操作和普通管道IO操作基本一样，但是**两者有一个主要的区别，在命名管道中，管道可以是事先已经创建好的**，比如我们在命令行下执行mkfifo myfifo就是创建一个命名通道，我们必须用open函数来显示地建立连接到管道的通道，而在管道中，管道已经在主进程里创建好了，然后在fork时直接复制相关数据或者是用exec创建的新进程时把管道的文件描述符当参数传递进去。

   　　一般来说FIFO和PIPE一样总是处于阻塞状态。也就是说如果命名管道FIFO打开时设置了读权限，则读进程将一直阻塞，一直到其他进程打开该FIFO并向管道写入数据。这个阻塞动作反过来也是成立的。如果不希望命名管道操作的时候发生阻塞，可以在open的时候使用O_NONBLOCK标志，以关闭默认的阻塞操作。

3. 信号量机制

   信号量是一种计数器，用于控制对多个进程共享的资源进行的访问。它们常常被用作一个锁机制，在某个进程正在对特定的资源进行操作时，信号量可以防止另一个进程去访问它。信号量是特殊的变量，它只取正整数值并且只允许对这个值进行两种操作：等待（wait）和信号（signal）。（P、V操作，P用于等待，V用于信号）

4. 共享内存

   共享内存是在多个进程之间共享内存区域的一种进程间的通信方式，由IPC为进程创建的一个特殊地址范围，它将出现在该进程的地址空间中。其他进程可以将**同一段共享内存连接到自己的地址空间中**。所有进程都可以访问共享内存中的地址，就好像它们是malloc分配的一样。如果一个进程向共享内存中写入了数据，所做的改动将立刻被其他进程看到。

   　　**共享内存是IPC最快捷的方式，因为共享内存方式的通信没有中间过程，**而管道、消息队列等方式则是需要将数据通过中间机制进行转换。共享内存方式直接将某段内存段进行映射，多个进程间的共享内存是同一块的物理空间，仅仅映射到各进程的地址不同而已，因此不需要进行复制，可以直接使用此段空间。

   　　**注意：共享内存本身并没有同步机制，需要程序员自己控制。**

5. socket通信

   就是通过声明一个socket绑定一个端口并进行监听来作为服务端，客户端通过connect来跟别的进程建立连接从而进行通信。

6. 消息队列

   **消息队列就是一个消息的链表。**可以把消息看作一个记录，具有特定的格式以及特定的优先级。对消息队列有写权限的进程可以向中按照一定的规则添加新消息；对消息队列有读权限的进程则可以从消息队列中读走消息。消息队列是随内核持续的。

   

