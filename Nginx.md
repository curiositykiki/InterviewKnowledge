Nginx 同 Apache 一样都**是一种 Web 服务器**。基于 REST 架构风格，以统一资源描述符（Uniform Resources Identifier）URI 或者统一资源定位符（Uniform Resources Locator）URL 作为沟通依据，通过 HTTP 协议提供各种网络服务。

Nginx 使用基于事件驱动架构，使得其可以支持数以百万级别的 TCP 连接。高度的模块化和自由软件许可证使得第三方模块层出不穷（这是个开源的时代啊）。Nginx 是一个跨平台服务器，可以运行在 Linux、Windows、FreeBSD、Solaris、AIX、Mac OS 等操作系统上。这些优秀的设计带来的极大的稳定性。

Nginx 可以作为一个 HTTP 服务器进行网站的发布处理，另外 Nginx 可以作为**反向代理**进行**负载均衡**的实现。



**正向代理**

正向代理，**它代理的是客户端**，是一个位于客户端和原始服务器（Origin Server）之间的服务器，为了从原始服务器取得内容，客户端向代理发送一个请求并指定目标（原始服务器）。

例如，我是客户端，原始服务器是google，但是我无法访问，所以我将这个请求发给代理服务器，代理服务器会代替我将这个请求发给google，然后返回的数据再又代理服务器发送给我。这个过程中代理服务器**隐藏了我的服务器**，google不知道是我发送的请求，同时代理服务器也将这个响应**缓存**在自己那里，如果有别人访问同样的资源则可以**加快响应速度**。

**正向代理的用途：**

访问原来无法访问的资源，如 Google。可以做缓存，加速访问资源。对客户端访问授权，上网进行认证。代理可以记录用户访问记录（上网行为管理），对外隐藏用户信息。



**反向代理**

反向代理，**它代理的是服务端，主要用于服务器集群分布式部署的情况**下，反向代理隐藏了服务器的信息。

例如，我要访问淘宝，我的请求发送给一个反向代理服务器，这个反向代理服务器**收到请求之后再分发给后端的业务处理服务器**进行处理，然后收到响应之后再发送给我。这个过程中，反向代理到后端服务器对我而言是透明的，我不知道哪里服务器帮我处理了，我只知道反向代理服务器是谁。

**反向代理的作用：**

保证内网的安全，通常将反向代理作为公网访问地址，Web 服务器是内网。负载均衡，通过反向代理服务器来优化网站的负载。



**负载均衡**：

这里提到的负载量是指客户端发送的、Nginx 反向代理服务器接收到的请求数量。**请求数量按照一定的规则进行分发，到不同的服务器处理的规则，就是一种均衡规则。**所以将服务器接收到的请求按照规则分发的过程，称为负载均衡。

通常分为硬件均衡负载和软件均衡负载，硬件对数据的稳定性安全性等保障更高，但是代价更昂贵。

软件负载：

1. weight 轮询（权重轮询）：接收到的请求**按照顺序逐一分配到不同的后端服务器（每个请求一个服务器）**，即使在使用过程中，某一台后端服务器宕机，Nginx 会自动**将该服务器剔除出队列**，请求受理情况不会受到任何影响。这种方式下，可以给不同的后端服务器**设置一个权重值（weight），用于调整不同的服务器上请求的分配率。权重数据越大，被分配到请求的几率越大；**该权重值，主要是针对实际工作环境中不同的后端服务器硬件配置进行调整的。

2. ip_hash：每个请求**按照发起客户端的 ip 的 hash 结果进行匹配**，这样的算法下一个固定 ip 地址的客户端总会访问到同一个后端服务器，这也在一定程度上解决了集群部署环境下 Session 共享的问题。

3. fair：智能调整调度算法，动态的**根据后端服务器的请求处理到响应的时间进行均衡分配**。

   响应时间短处理效率高的服务器分配到请求的概率高，响应时间长处理效率低的服务器分配到的请求少，它是结合了前两者的优点的一种调度算法。

4. url_hash：**按照访问的 URL 的 hash 结果分配请求**，每个请求的 URL 会指向后端固定的某个服务器，可以在 Nginx 作为静态服务器的情况下提高缓存效率。

硬件负载：

硬件负载均衡解决方案是**直接在服务器和外部网络间安装负载均衡设备**，这种设备我们通常称之为负载均衡器，由于专门的设备完成网络请求转发的任务，**独立于操作系统，整体性能高**，负载均衡策略多样化，流量管理智能化。

详细请看：https://www.sohu.com/a/290974098_99906077